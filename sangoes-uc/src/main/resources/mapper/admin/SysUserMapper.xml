<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sangoes.boot.uc.modules.admin.mapper.SysUserMapper">

    <!-- userDetails级联 -->
    <resultMap id="userDetailsCascadeResult" type="com.sangoes.boot.uc.modules.admin.vo.UserDetailsVo">
        <id column="id" property="id"/>
        <result property="username" column="username"/>
        <result property="password" column="password"/>
        <result property="status" column="status"/>
        <association property="roles" resultMap="roleResult"/>
    </resultMap>

    <!--role-->
    <resultMap id="roleResult" type="com.sangoes.boot.uc.modules.admin.entity.SysRole">
        <id column="id" property="id"/>
        <result property="roleName" column="role_name"/>
        <result property="roleCode" column="role_code"/>
    </resultMap>

    <!---->
    <select id="selectUserDetailsByUsername" resultMap="userDetailsCascadeResult">
        SELECT
        u.id,
        u.username,
        u.password,
        u.status
        FROM sys_user u
        LEFT JOIN sys_user_role ur ON ur.user_id = u.id
        LEFT JOIN sys_role r ON r.id = ur.role_id
        where u.username = #{username}
    </select>


</mapper>
